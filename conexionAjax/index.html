<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="jquery-3.6.0.min.js"> </script>
    <title>Reservas</title>
</head>
<style>
    *{
        margin:0;
        padding:0;
    }
    .container{
        display:flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
    }
    .container h3{
        font-size: 40px;
        font-family: Arial, Helvetica, sans-serif;
        margin-bottom: 20px;
    }
    input{
        padding:10px 15px;
    }
    table, th, td {
      border:1px solid black;
    }
    td{
        width: 100px;
        height: 40px;
    }
</style>

<body>
    <h3>formulario </h3>
    <form action="" method="post">
        <input type="text" name="id" id="id" placeholder="ID">
        <input type="text" name="room" id="room" placeholder="Nombre">
        <input type="text" name="stars" id="stars" placeholder="Estrellas">
        <input type="text" name="category_id" id="category_id" placeholder="Categoria">
        <input type="text" name="description" id="description" placeholder="Descripción">
        <input type="button" value="Subir datos" id="send">
        <input type="button" value="Obtener valores actuales" id="getbtn">
    </form>

    <h2>Tabla:</h2>
    <div id = "container_table"></div>

    <a href="mensaje.html">Dejar un menaje</a>
    

    <p id="getInfo"></p>

    <script>
        var id= document.getElementById('id');
        var room= document.getElementById('room');
        var stars= document.getElementById('stars');
        var category_id= document.getElementById('category_id');
        var description= document.getElementById('description');
        var send= document.getElementById('send');
        var getbtn= document.getElementById('getbtn');
        var getInfo= document.getElementById('getInfo');
            
        //Table
        var container_table= document.getElementById('container_table');

        container_table.innerHTML="<table class='default'><tr><td>ID</td><td>Nombre</td><td>Estrellas</td><td>Categoria</td><td>Descripcion</td></tr></table>"

        send.addEventListener("click",function(){
            postDates();
        })
        getbtn.addEventListener("click",function(){
            getDates();
        })
        function getDates(){
            const ajax = $.ajax({
                method:"GET",
                url:"https://ge8d0967bd45c71-room.adb.sa-santiago-1.oraclecloudapps.com/ords/admin/room/room"
            })
            ajax.done(function(g){
                getInfo.innerHTML = "";
                container_table.innerHTML="<table class='default'><tr><td>ID</td><td>Nombre</td><td>Estrellas</td><td>Categoria</td><td>Descripcion</td></tr></table>"
                console.log(g);
                console.log("the message is:");
                console.log(g);
                let array1 = [] 
                for (let i = 0; i < g.items.length; i++) {
                  array1.push(g.items[i])  
                }
                    array1.forEach(element => {
                        container_table.innerHTML+="<table class='default'><tr><td>"+element.id+"</td><td>"+element.room+"</td><td>"+element.stars+"</td><td>"+element.category_id+"</td><td>"+element.description+"</td></tr></table>"           
                    });      
            })
            ajax.fail(function(g){
                console.log(g);
                window.alert("Ocurrió un error en la consulta, intente de nuevo");
            })
        }
    function postDates(){
        var ajax = $.ajax({
          type:"POST",
          url:"https://ge8d0967bd45c71-room.adb.sa-santiago-1.oraclecloudapps.com/ords/admin/room/room",
          data:{
              id:parseInt(id.value),
              room:room.value,
              stars:parseInt(stars.value),
              category_id:parseInt(category_id.value),
              description:description.value
            } 
        })
        ajax.done(function(g){
            console.log("the message is:");
            console.log(g);
            window.alert('Datos cargados con éxito');
            
            id.value=null;
            room.value=null;
            stars.value=null;
            category_id.value=null;
            description.value=null;
        })
        ajax.fail(function(g){
            console.log("not send sorry");
            console.log(g);
            window.alert('Hubo un error al insertar los datos, intente de nuevo');
        })
    } 
    </script>
</body>
</html>